<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <section>
        <table>
            <tr>
                <td id="resultado" colspan="4"><output id="iresultado">0</output></td>
            </tr>
            <tr>
                <td>%</td>
                <td onclick="resetAll()">CE</td>
                <td>C</td>
                <td onclick="numerosRemove()"><span class="material-symbols-outlined">backspace</span></td>
            </tr>
            <tr>
                <td>1/x</td>
                <td>xÂ²</td>
                <td>^</td>
                <td onclick="Conta('/')">/</td>
            </tr>
            <tr>
                <td onclick="numerosGuard(7)">7</td>
                <td onclick="numerosGuard(8)">8</td>
                <td onclick="numerosGuard(9)">9</td>
                <td onclick="Conta('*')">*</td>
            </tr>
            <tr>
                <td onclick="numerosGuard(4)">4</td>
                <td onclick="numerosGuard(5)">5</td>
                <td onclick="numerosGuard(6)">6</td>
                <td onclick="Conta('-')">-</td>
            </tr>
            <tr>
                <td onclick="numerosGuard(1)">1</td>
                <td onclick="numerosGuard(2)">2</td>
                <td onclick="numerosGuard(3)">3</td>
                <td onclick="Conta('+')">+</td>
            </tr>
            <tr>
                <td>+/-</td>
                <td onclick="numerosGuard(0)">0</td>
                <td onclick="numerosGuard(',')">,</td>
                <td onclick="resultado()">=</td>
            </tr>
        </table>
    </section>
    <script>

        const guardnumeros = [];
        let numeros = [];
        let guardCalc;
        let DigitadoResultado = [];
        
        function numerosGuard(num){
            guardnumeros.push(num); //Guarda o Numero
            updateResultado('adicionar',num.toString()); //Update para guardar o numero na tela
        }

        function numerosRemove(){
            guardnumeros.splice(guardnumeros.length-1); //Remove o ultimo numero
            updateResultado('remover','0');    //Remove o ultimo numero da tela
        }

        function Conta(soma){
            guardCalc=soma;
            if(numeros[0]==undefined){
                numeros[0] = Number(guardnumeros.join(''));
                guardnumeros.splice(0,guardnumeros.length);
                updateResultado('soma',soma);
            }else if(numeros[0]!=undefined && numeros[1]!=undefined){
                numeros[1] = Number(guardnumeros.join(''));
                guardnumeros.splice(0,guardnumeros.length);
                updateResultado('soma',soma);
            }

            if(numeros[0]!=undefined && numeros[1]!=undefined){
                resultado();
            }
            

        }

        function resetConta(value){
            updateResultado('resultado',value.toString()); //Update na tela guardando o resultado e aparecendo na tela
            numeros[0] = value; //Guarda o resultado no primeiro GuardConta para ser reutilizado
            numeros[1] = 0;
        }

        function resultado(){
            if(numeros[1]!=undefined){
                resetConta(numeros[0]);
            }else{
                numeros[1] = Number(guardnumeros.join(''));
                guardnumeros.splice(0,guardnumeros.length);
                Somar(guardCalc);
            }
        }

        function Somar(soma){
            if(soma=='+'){
                    guardResult=numeros[0]+numeros[1]; //+
                    resetConta(guardResult);
                }else if(soma=='-'){
                    guardResult=numeros[0]-numeros[1]; //-
                    resetConta(guardResult);
                }else if(soma=='*'){
                    guardResult=numeros[0]*numeros[1]; //*
                    resetConta(guardResult);
                }else if(soma=='/'){
                    guardResult=numeros[0]/numeros[1]; ///
                    resetConta(guardResult);
                }
        }

        function resetAll(){
            guardnumeros.splice(0,guardnumeros.length);
            guardConta.splice(0,guardConta.length);
            guardCalc = 0;
            guardResult = 0; 
        }

        function updateResultado(natureza,Digitar){
            if(natureza=='adicionar'){
                DigitadoResultado.push(Digitar);
            }else if(natureza=='soma'){
                if(DigitadoResultado[DigitadoResultado.length-1]=='+' || DigitadoResultado[DigitadoResultado.length-1]=='-' || DigitadoResultado[DigitadoResultado.length-1]=='*' || DigitadoResultado[DigitadoResultado.length-1]=='/'){
                    DigitadoResultado[DigitadoResultado.length-1]=Digitar;
                }else{
                    DigitadoResultado.push(Digitar);
                }
            }else if(natureza=='remover'){
                DigitadoResultado.splice(DigitadoResultado.length-1)
            }else if(natureza=='resultado'){
                DigitadoResultado.splice(0,DigitadoResultado.length)
                DigitadoResultado.push(Digitar);
            }

            if(DigitadoResultado.length==0){
                iresultado.innerHTML = 0;
            }else{
                iresultado.innerHTML = DigitadoResultado.join('');
            }

        }
    </script>
</body>
</html>